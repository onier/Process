<Process xmlns="">
    <TaskManager taskName="slave马达控制流程">
        <tasks>
            <StartTask NextTaskID="slaveMotorCalibrationCheck" id="slave_motor_start_task"
                       name="slave_motor_start_task"/>

            <FakeTask NextTaskID="checkSlaveCalibrationGateway"
                      id="slaveMotorCalibrationCheck"
                      name="startCalibration" Text="启动校准">
                <map keyType="std::string" name="Values" valueType="std::string">
                    <item>
                        <key type="std::string" value="CheckSlateMotroCalibrationState"/>
                        <value type="std::string" value="YES"/>
                    </item>
                    <item>
                        <key type="std::string" value="CheckMasterVisionResult"/>
                        <value type="std::string" value="YES"/>
                    </item>
                    <item>
                        <key type="std::string" value="CheckSlaveVisionResult"/>
                        <value type="std::string" value="YES"/>
                    </item>
                </map>
            </FakeTask>

            <ExclusiveGateway id="checkSlaveCalibrationGateway">
                <list name="SubTasks" type="ExclusiveRule">
                    <ExclusiveRule Operator="=" TaskID="slave_motor_calibration" Value="YES"
                                   Type="string" ValueName="CheckSlateMotroCalibrationState"/>
                    <ExclusiveRule Operator="=" TaskID="slaveMoveToThirdPosition" Value="NO" Type="string"
                                   ValueName="CheckSlateMotroCalibrationState"/>
                </list>
            </ExclusiveGateway>

            <FakeTask id="slaveMoveToThirdPosition" Int="500" NextTaskID="checkMasterVisionResult" Text="slave移动到third点" />

            <SubProcessTask id="slave_motor_calibration" NextTaskID="slaveMoveToThirdPosition">
                <SubTaskManager taskName="slave电机校准子流程">
                    <tasks>
                        <StartTask NextTaskID="slave_motor_calibration_end_task" id="slave_motor_calibration_start_task"
                                   name="slave_motor_calibration_start_task"/>

                        <EndTask  id="slave_motor_calibration_end_task"
                                  name="slave_motor_calibration_end_task"/>
                    </tasks>
                </SubTaskManager>
            </SubProcessTask>
<!--判断master的检测结果-->
            <ExclusiveGateway id="checkMasterVisionResult">
                <list name="SubTasks" type="ExclusiveRule">
                    <ExclusiveRule Operator="=" TaskID="slave_side_check_process" Value="YES"
                                   Type="string" ValueName="CheckMasterVisionResult"/>
                    <ExclusiveRule Operator="=" TaskID="slavePickForVisionFail" Value="NO" Type="string"
                                   ValueName="CheckMasterVisionResult"/>
                </list>
            </ExclusiveGateway>

<!--slave端面检测流程-->
            <SubProcessTask id="slave_side_check_process" NextTaskID="checkSlaveVisionResult">
                <SubTaskManager taskName="slave端面检测子流程">
                    <tasks>
                        <StartTask NextTaskID="slave_side_check_process_end_task" id="slave_side_check_process_start_task"
                                   name="slave_side_check_process_start_task"/>

                        <EndTask  id="slave_side_check_process_end_task"
                                  name="slave_side_check_process_end_task"/>
                    </tasks>
                </SubTaskManager>
            </SubProcessTask>
<!--判断端面检测结果-->
            <ExclusiveGateway id="checkSlaveVisionResult">
                <list name="SubTasks" type="ExclusiveRule">
                    <ExclusiveRule Operator="=" TaskID="slavePickForVisionSucess" Value="YES"
                                   Type="string" ValueName="CheckSlaveVisionResult"/>
                    <ExclusiveRule Operator="=" TaskID="slavePickForVisionFail" Value="NO" Type="string"
                                   ValueName="CheckSlaveVisionResult"/>
                </list>
            </ExclusiveGateway>


            <FakeTask id="slavePickForVisionSucess" Int = "200" NextTaskID="slaveMoveToVisionSucessPositon" Text="slave视觉检测成功抓取" />
            <FakeTask id="slaveMoveToVisionSucessPositon" NextTaskID="slavePlaceForVisionSucess" Int = "200" Text="移动到视觉检测成功的放置点" />
            <FakeTask id="slavePlaceForVisionSucess" NextTaskID="notifyMasterMotorToMove" Int = "200" Text="视觉检测成功放置" />


            <FakeTask id="slavePickForVisionFail" NextTaskID="slaveMoveToVisionFailPositon" Int = "200" Text="slave视觉检测失败抓取" />
            <FakeTask id="slaveMoveToVisionFailPositon" NextTaskID="slavePlaceForVisionFail"  Int = "200" Text="移动到视觉检测失败的放置点" />
            <FakeTask id="slavePlaceForVisionFail" NextTaskID="notifyMasterMotorToMove" Int = "200" Text="视觉检测失败放置" />
            <FakeTask id="notifyMasterMotorToMove" NextTaskID="slave_motor_end_task" Text="通知master电机开始进入干涉区域" />


            <EndTask id="slave_motor_end_task"
                     name="slave_motor_end_task"/>
        </tasks>
    </TaskManager>
</Process>